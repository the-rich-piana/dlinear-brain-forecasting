Args in experiment:
Namespace(is_training=1, model_id='Autoformer_336_96', model='Autoformer', data='Activity', root_path='./dataset/', data_path='session_0.h5', features='M', target='OT', freq='m', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=5000, dec_in=5000, c_out=5000, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=32, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_336_96_Autoformer_Activity_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Loaded preprocessed data: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Selected top 5000 neurons out of 6903 preprocessed neurons
Final dataset shape: (13356, 5000)
Final data statistics - Mean: 0.347, Std: 0.149
train 12925
Loaded preprocessed data: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Selected top 5000 neurons out of 6903 preprocessed neurons
Final dataset shape: (2244, 5000)
Final data statistics - Mean: 0.380, Std: 0.158
val 1813
Loaded preprocessed data: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Selected top 5000 neurons out of 6903 preprocessed neurons
Final dataset shape: (4153, 5000)
Final data statistics - Mean: 0.326, Std: 0.144
test 3722
	iters: 100, epoch: 1 | loss: 0.0194106
	speed: 0.3734s/iter; left time: 15009.2341s
	iters: 200, epoch: 1 | loss: 0.0160452
	speed: 0.2742s/iter; left time: 10996.3662s
	iters: 300, epoch: 1 | loss: 0.0132054
	speed: 0.2188s/iter; left time: 8751.9051s
	iters: 400, epoch: 1 | loss: 0.0133559
	speed: 0.3114s/iter; left time: 12426.6971s
Epoch: 1 cost time: 112.4338891506195
Epoch: 1, Steps: 403 | Train Loss: 0.0211069 Vali Loss: 0.0145798 Test Loss: 0.0112198
Validation loss decreased (inf --> 0.014580).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0141226
	speed: 1.3436s/iter; left time: 53474.4026s
	iters: 200, epoch: 2 | loss: 0.0138037
	speed: 0.3164s/iter; left time: 12558.8562s
	iters: 300, epoch: 2 | loss: 0.0135297
	speed: 0.3267s/iter; left time: 12937.5082s
	iters: 400, epoch: 2 | loss: 0.0135662
	speed: 0.3122s/iter; left time: 12332.0502s
Epoch: 2 cost time: 128.83118081092834
Epoch: 2, Steps: 403 | Train Loss: 0.0136364 Vali Loss: 0.0144851 Test Loss: 0.0111695
Validation loss decreased (0.014580 --> 0.014485).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0126649
	speed: 1.0560s/iter; left time: 41603.0353s
	iters: 200, epoch: 3 | loss: 0.0124814
	speed: 0.1250s/iter; left time: 4913.4341s
	iters: 300, epoch: 3 | loss: 0.0130762
	speed: 0.1249s/iter; left time: 4894.2702s
	iters: 400, epoch: 3 | loss: 0.0127268
	speed: 0.1238s/iter; left time: 4841.6335s
Epoch: 3 cost time: 50.767234802246094
Epoch: 3, Steps: 403 | Train Loss: 0.0130703 Vali Loss: 0.0143258 Test Loss: 0.0110090
Validation loss decreased (0.014485 --> 0.014326).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0129185
	speed: 0.4000s/iter; left time: 15595.2957s
	iters: 200, epoch: 4 | loss: 0.0131749
	speed: 0.1243s/iter; left time: 4835.6822s
	iters: 300, epoch: 4 | loss: 0.0135747
	speed: 0.1244s/iter; left time: 4825.3681s
	iters: 400, epoch: 4 | loss: 0.0131894
	speed: 0.1240s/iter; left time: 4796.0885s
Epoch: 4 cost time: 50.60515356063843
Epoch: 4, Steps: 403 | Train Loss: 0.0130411 Vali Loss: 0.0142989 Test Loss: 0.0109783
Validation loss decreased (0.014326 --> 0.014299).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0125954
	speed: 0.4008s/iter; left time: 15465.0448s
	iters: 200, epoch: 5 | loss: 0.0129367
	speed: 0.1241s/iter; left time: 4778.0846s
	iters: 300, epoch: 5 | loss: 0.0127910
	speed: 0.1244s/iter; left time: 4776.1274s
	iters: 400, epoch: 5 | loss: 0.0135914
	speed: 0.1236s/iter; left time: 4731.6866s
Epoch: 5 cost time: 50.52910280227661
Epoch: 5, Steps: 403 | Train Loss: 0.0129573 Vali Loss: 0.0142702 Test Loss: 0.0109581
Validation loss decreased (0.014299 --> 0.014270).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0126540
	speed: 0.3953s/iter; left time: 15095.3125s
	iters: 200, epoch: 6 | loss: 0.0126664
	speed: 0.1244s/iter; left time: 4737.6228s
	iters: 300, epoch: 6 | loss: 0.0124580
	speed: 0.1243s/iter; left time: 4721.7364s
	iters: 400, epoch: 6 | loss: 0.0126588
	speed: 0.1234s/iter; left time: 4674.5659s
Epoch: 6 cost time: 50.4887330532074
Epoch: 6, Steps: 403 | Train Loss: 0.0129167 Vali Loss: 0.0142606 Test Loss: 0.0109417
Validation loss decreased (0.014270 --> 0.014261).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0123060
	speed: 0.3950s/iter; left time: 14922.4602s
	iters: 200, epoch: 7 | loss: 0.0125530
	speed: 0.1242s/iter; left time: 4678.5902s
	iters: 300, epoch: 7 | loss: 0.0133167
	speed: 0.1241s/iter; left time: 4663.5468s
	iters: 400, epoch: 7 | loss: 0.0130740
	speed: 0.1233s/iter; left time: 4621.6084s
Epoch: 7 cost time: 50.48854398727417
Epoch: 7, Steps: 403 | Train Loss: 0.0128882 Vali Loss: 0.0142428 Test Loss: 0.0109340
Validation loss decreased (0.014261 --> 0.014243).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0135889
	speed: 0.3972s/iter; left time: 14845.6534s
	iters: 200, epoch: 8 | loss: 0.0127960
	speed: 0.1242s/iter; left time: 4628.6704s
	iters: 300, epoch: 8 | loss: 0.0135283
	speed: 0.1244s/iter; left time: 4626.5456s
	iters: 400, epoch: 8 | loss: 0.0135324
	speed: 0.1236s/iter; left time: 4583.6721s
Epoch: 8 cost time: 50.55028986930847
Epoch: 8, Steps: 403 | Train Loss: 0.0128763 Vali Loss: 0.0142446 Test Loss: 0.0109273
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0126541
	speed: 0.3799s/iter; left time: 14045.7475s
	iters: 200, epoch: 9 | loss: 0.0127782
	speed: 0.1243s/iter; left time: 4583.9666s
	iters: 300, epoch: 9 | loss: 0.0125089
	speed: 0.1243s/iter; left time: 4571.6182s
	iters: 400, epoch: 9 | loss: 0.0127002
	speed: 0.1234s/iter; left time: 4525.4955s
Epoch: 9 cost time: 50.50487685203552
Epoch: 9, Steps: 403 | Train Loss: 0.0128702 Vali Loss: 0.0142402 Test Loss: 0.0109242
Validation loss decreased (0.014243 --> 0.014240).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0131127
	speed: 0.4041s/iter; left time: 14780.2008s
	iters: 200, epoch: 10 | loss: 0.0125170
	speed: 0.1241s/iter; left time: 4525.6431s
	iters: 300, epoch: 10 | loss: 0.0131478
	speed: 0.1244s/iter; left time: 4523.2558s
	iters: 400, epoch: 10 | loss: 0.0132500
	speed: 0.1232s/iter; left time: 4469.7705s
Epoch: 10 cost time: 50.4766526222229
Epoch: 10, Steps: 403 | Train Loss: 0.0128664 Vali Loss: 0.0142297 Test Loss: 0.0109226
Validation loss decreased (0.014240 --> 0.014230).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0129082
	speed: 0.3942s/iter; left time: 14258.6357s
	iters: 200, epoch: 11 | loss: 0.0121565
	speed: 0.1240s/iter; left time: 4472.9047s
	iters: 300, epoch: 11 | loss: 0.0137255
	speed: 0.1243s/iter; left time: 4471.4544s
	iters: 400, epoch: 11 | loss: 0.0129794
	speed: 0.1234s/iter; left time: 4425.4841s
Epoch: 11 cost time: 50.47348880767822
Epoch: 11, Steps: 403 | Train Loss: 0.0128637 Vali Loss: 0.0142317 Test Loss: 0.0109218
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.0128926
	speed: 0.3811s/iter; left time: 13631.7424s
	iters: 200, epoch: 12 | loss: 0.0124001
	speed: 0.1241s/iter; left time: 4426.6858s
	iters: 300, epoch: 12 | loss: 0.0120459
	speed: 0.1243s/iter; left time: 4421.3965s
	iters: 400, epoch: 12 | loss: 0.0127964
	speed: 0.1234s/iter; left time: 4377.2880s
Epoch: 12 cost time: 50.51963782310486
Epoch: 12, Steps: 403 | Train Loss: 0.0128619 Vali Loss: 0.0142267 Test Loss: 0.0109217
Validation loss decreased (0.014230 --> 0.014227).  Saving model ...
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.0125731
	speed: 0.4025s/iter; left time: 14234.7327s
	iters: 200, epoch: 13 | loss: 0.0130493
	speed: 0.1241s/iter; left time: 4375.2759s
	iters: 300, epoch: 13 | loss: 0.0134106
	speed: 0.1243s/iter; left time: 4370.8491s
	iters: 400, epoch: 13 | loss: 0.0121310
	speed: 0.1233s/iter; left time: 4323.3207s
Epoch: 13 cost time: 50.47327756881714
Epoch: 13, Steps: 403 | Train Loss: 0.0128622 Vali Loss: 0.0142327 Test Loss: 0.0109211
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.0126016
	speed: 0.3807s/iter; left time: 13310.7782s
	iters: 200, epoch: 14 | loss: 0.0123546
	speed: 0.1241s/iter; left time: 4326.8153s
	iters: 300, epoch: 14 | loss: 0.0128645
	speed: 0.1243s/iter; left time: 4320.4713s
	iters: 400, epoch: 14 | loss: 0.0128752
	speed: 0.1233s/iter; left time: 4274.7534s
Epoch: 14 cost time: 50.47263860702515
Epoch: 14, Steps: 403 | Train Loss: 0.0128623 Vali Loss: 0.0142348 Test Loss: 0.0109212
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.0128401
	speed: 0.3807s/iter; left time: 13155.7914s
	iters: 200, epoch: 15 | loss: 0.0132000
	speed: 0.1240s/iter; left time: 4272.2116s
	iters: 300, epoch: 15 | loss: 0.0129721
	speed: 0.1242s/iter; left time: 4266.7639s
	iters: 400, epoch: 15 | loss: 0.0126905
	speed: 0.1231s/iter; left time: 4218.8871s
Epoch: 15 cost time: 50.40025091171265
Epoch: 15, Steps: 403 | Train Loss: 0.0128625 Vali Loss: 0.0142304 Test Loss: 0.0109210
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_336_96_Autoformer_Activity_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Loaded preprocessed data: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Selected top 5000 neurons out of 6903 preprocessed neurons
Final dataset shape: (4153, 5000)
Final data statistics - Mean: 0.326, Std: 0.144
test 3722
mse:0.010921751148998737, mae:0.07487650960683823, rse:0.7305371761322021, corr:[0.11070599 0.10736717 0.10526763 0.10395065 0.10355899 0.10358119
 0.1038124  0.10402043 0.10441678 0.10456847 0.10456096 0.10401079
 0.10313447 0.10246425 0.10227082 0.10216503 0.10208815 0.10199872
 0.10193858 0.1018477  0.10174888 0.10163942 0.10151129 0.10138125
 0.10124838 0.1011197  0.10098301 0.10085607 0.10075808 0.10067651
 0.10058874 0.10050847 0.10044364 0.1003959  0.10034875 0.1002951
 0.10023744 0.10018459 0.100123   0.10005149 0.09997547 0.09989702
 0.0998177  0.09972885 0.09964872 0.09957193 0.09949733 0.09941331
 0.09931934 0.09920401 0.09907812 0.09895769 0.09884266 0.09872154
 0.09859625 0.09847355 0.09834973 0.09821488 0.09806791 0.09792083
 0.09777354 0.09763221 0.09750157 0.0973703  0.09722836 0.09707686
 0.09691975 0.09676012 0.09659955 0.09643345 0.09629216 0.0961378
 0.09596893 0.09579493 0.09561232 0.09540739 0.09518491 0.09493543
 0.09465358 0.09433145 0.09393608 0.09344702 0.09323818 0.09325112
 0.09364198 0.09366308 0.09326061 0.09247284 0.0913364  0.09003446
 0.08863436 0.08665282 0.08513125 0.08267486 0.07843529 0.06636367]
