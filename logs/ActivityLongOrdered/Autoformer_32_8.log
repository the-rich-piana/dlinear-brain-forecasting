Args in experiment:
Namespace(is_training=1, model_id='Autoformer_32_8', model='Autoformer', data='ActivityOrdered', root_path='./dataset/', data_path='session_0.h5', features='M', target='OT', freq='m', checkpoints='./checkpoints/', seq_len=32, label_len=32, pred_len=8, individual=False, embed_type=0, enc_in=5000, dec_in=5000, c_out=5000, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.01, des='Exp', loss='mae', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_32_8_Autoformer_ActivityOrdered_ftM_sl32_ll32_pl8_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Brain data loaded: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Temporal split - Total time: 19081
Train: 0 to 16218 (85.0%)
Val: 16218 to 18126 (10.0%)
Test: 18126 to 19081 (5.0%)
Current split (train): 0 to 16218
Selected top 5000 neurons out of 6903 total
Selected neuron std range: 0.105 to 0.267
Final dataset shape: (16218, 5000)
Final data stats - Mean: 0.350, Std: 0.150
Sequences available: 16179
train 16179
Brain data loaded: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Temporal split - Total time: 19081
Train: 0 to 16218 (85.0%)
Val: 16218 to 18126 (10.0%)
Test: 18126 to 19081 (5.0%)
Current split (val): 16186 to 18126
Selected top 5000 neurons out of 6903 total
Selected neuron std range: 0.105 to 0.267
Final dataset shape: (1940, 5000)
Final data stats - Mean: 0.323, Std: 0.141
Sequences available: 1901
val 1901
Brain data loaded: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Temporal split - Total time: 19081
Train: 0 to 16218 (85.0%)
Val: 16218 to 18126 (10.0%)
Test: 18126 to 19081 (5.0%)
Current split (test): 18094 to 19081
Selected top 5000 neurons out of 6903 total
Selected neuron std range: 0.105 to 0.267
Final dataset shape: (987, 5000)
Final data stats - Mean: 0.356, Std: 0.150
Sequences available: 948
test 948
	iters: 100, epoch: 1 | loss: 84.7204514
	speed: 0.0765s/iter; left time: 378.9412s
	iters: 200, epoch: 1 | loss: 48.6098175
	speed: 0.0427s/iter; left time: 206.9755s
	iters: 300, epoch: 1 | loss: 44.1911774
	speed: 0.0404s/iter; left time: 192.1231s
	iters: 400, epoch: 1 | loss: 35.0480537
	speed: 0.0424s/iter; left time: 197.0423s
	iters: 500, epoch: 1 | loss: 19.6750469
	speed: 0.0432s/iter; left time: 196.4335s
Epoch: 1 cost time: 22.21163272857666
Epoch: 1, Steps: 505 | Train Loss: 1543.9956709 Vali Loss: 3.4125268 Test Loss: 1.9497691
Validation loss decreased (inf --> 3.412527).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 18.7537956
	speed: 0.0986s/iter; left time: 438.2919s
	iters: 200, epoch: 2 | loss: 15.7529869
	speed: 0.0440s/iter; left time: 191.1618s
	iters: 300, epoch: 2 | loss: 10.4307375
	speed: 0.0429s/iter; left time: 181.9990s
	iters: 400, epoch: 2 | loss: 8.8228064
	speed: 0.0450s/iter; left time: 186.4513s
	iters: 500, epoch: 2 | loss: 8.0753555
	speed: 0.0446s/iter; left time: 180.5428s
Epoch: 2 cost time: 22.414207458496094
Epoch: 2, Steps: 505 | Train Loss: 12.7198425 Vali Loss: 1.5814559 Test Loss: 0.8750281
Validation loss decreased (3.412527 --> 1.581456).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 6.3933048
	speed: 0.1017s/iter; left time: 400.6229s
	iters: 200, epoch: 3 | loss: 6.2931809
	speed: 0.0400s/iter; left time: 153.7695s
	iters: 300, epoch: 3 | loss: 5.8708053
	speed: 0.0387s/iter; left time: 144.8055s
	iters: 400, epoch: 3 | loss: 5.6567502
	speed: 0.0411s/iter; left time: 149.5035s
	iters: 500, epoch: 3 | loss: 4.6490211
	speed: 0.0453s/iter; left time: 160.4913s
Epoch: 3 cost time: 21.63589882850647
Epoch: 3, Steps: 505 | Train Loss: 6.0796300 Vali Loss: 0.9539276 Test Loss: 0.5339779
Validation loss decreased (1.581456 --> 0.953928).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 4.4839997
	speed: 0.0992s/iter; left time: 340.7293s
	iters: 200, epoch: 4 | loss: 4.1724477
	speed: 0.0423s/iter; left time: 141.1883s
	iters: 300, epoch: 4 | loss: 4.8652101
	speed: 0.0421s/iter; left time: 136.3611s
	iters: 400, epoch: 4 | loss: 4.0049267
	speed: 0.0438s/iter; left time: 137.4435s
	iters: 500, epoch: 4 | loss: 3.6355667
	speed: 0.0403s/iter; left time: 122.3787s
Epoch: 4 cost time: 21.633522033691406
Epoch: 4, Steps: 505 | Train Loss: 4.3195345 Vali Loss: 0.7179123 Test Loss: 0.4053049
Validation loss decreased (0.953928 --> 0.717912).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.7795398
	speed: 0.1011s/iter; left time: 296.4578s
	iters: 200, epoch: 5 | loss: 4.0956683
	speed: 0.0459s/iter; left time: 130.0072s
	iters: 300, epoch: 5 | loss: 3.6210840
	speed: 0.0441s/iter; left time: 120.4974s
	iters: 400, epoch: 5 | loss: 3.5668039
	speed: 0.0432s/iter; left time: 113.5392s
	iters: 500, epoch: 5 | loss: 2.8060055
	speed: 0.0391s/iter; left time: 99.0856s
Epoch: 5 cost time: 21.981181144714355
Epoch: 5, Steps: 505 | Train Loss: 3.4722418 Vali Loss: 0.5255091 Test Loss: 0.3137273
Validation loss decreased (0.717912 --> 0.525509).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.4351280
	speed: 0.0973s/iter; left time: 235.9975s
	iters: 200, epoch: 6 | loss: 3.3142319
	speed: 0.0435s/iter; left time: 101.1142s
	iters: 300, epoch: 6 | loss: 2.9392447
	speed: 0.0415s/iter; left time: 92.3831s
	iters: 400, epoch: 6 | loss: 2.7335057
	speed: 0.0393s/iter; left time: 83.4938s
	iters: 500, epoch: 6 | loss: 3.0007007
	speed: 0.0391s/iter; left time: 79.1393s
Epoch: 6 cost time: 20.894882202148438
Epoch: 6, Steps: 505 | Train Loss: 2.9897493 Vali Loss: 0.4226056 Test Loss: 0.2626330
Validation loss decreased (0.525509 --> 0.422606).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 2.3543551
	speed: 0.1011s/iter; left time: 194.1185s
	iters: 200, epoch: 7 | loss: 2.5520906
	speed: 0.0435s/iter; left time: 79.1281s
	iters: 300, epoch: 7 | loss: 2.5100660
	speed: 0.0418s/iter; left time: 72.0084s
	iters: 400, epoch: 7 | loss: 2.3648612
	speed: 0.0441s/iter; left time: 71.4751s
	iters: 500, epoch: 7 | loss: 2.7987194
	speed: 0.0417s/iter; left time: 63.4124s
Epoch: 7 cost time: 22.08858013153076
Epoch: 7, Steps: 505 | Train Loss: 2.6952369 Vali Loss: 0.3770469 Test Loss: 0.2405785
Validation loss decreased (0.422606 --> 0.377047).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 2.5870967
	speed: 0.1130s/iter; left time: 159.9660s
	iters: 200, epoch: 8 | loss: 2.6891282
	speed: 0.0422s/iter; left time: 55.5471s
	iters: 300, epoch: 8 | loss: 2.2339051
	speed: 0.0400s/iter; left time: 48.6590s
	iters: 400, epoch: 8 | loss: 2.8961310
	speed: 0.0420s/iter; left time: 46.8533s
	iters: 500, epoch: 8 | loss: 2.3746057
	speed: 0.0397s/iter; left time: 40.3846s
Epoch: 8 cost time: 21.51438069343567
Epoch: 8, Steps: 505 | Train Loss: 2.5096827 Vali Loss: 0.2924525 Test Loss: 0.2048135
Validation loss decreased (0.377047 --> 0.292453).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 2.4650323
	speed: 0.0974s/iter; left time: 88.6860s
	iters: 200, epoch: 9 | loss: 2.2262619
	speed: 0.0424s/iter; left time: 34.3922s
	iters: 300, epoch: 9 | loss: 2.3272059
	speed: 0.0405s/iter; left time: 28.7698s
	iters: 400, epoch: 9 | loss: 2.6714787
	speed: 0.0419s/iter; left time: 25.6233s
	iters: 500, epoch: 9 | loss: 2.8835495
	speed: 0.0419s/iter; left time: 21.4071s
Epoch: 9 cost time: 21.34295892715454
Epoch: 9, Steps: 505 | Train Loss: 2.3837164 Vali Loss: 0.2652676 Test Loss: 0.1929286
Validation loss decreased (0.292453 --> 0.265268).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 2.2706864
	speed: 0.1012s/iter; left time: 41.1067s
	iters: 200, epoch: 10 | loss: 2.3979549
	speed: 0.0433s/iter; left time: 13.2505s
	iters: 300, epoch: 10 | loss: 1.8613769
	speed: 0.0396s/iter; left time: 8.1581s
	iters: 400, epoch: 10 | loss: 2.3602455
	speed: 0.0419s/iter; left time: 4.4437s
	iters: 500, epoch: 10 | loss: 2.1766233
	speed: 0.0447s/iter; left time: 0.2683s
Epoch: 10 cost time: 21.93588161468506
Epoch: 10, Steps: 505 | Train Loss: 2.2996026 Vali Loss: 0.2319093 Test Loss: 0.1804441
Validation loss decreased (0.265268 --> 0.231909).  Saving model ...
Updating learning rate to 1.953125e-05
>>>>>>>testing : Autoformer_32_8_Autoformer_ActivityOrdered_ftM_sl32_ll32_pl8_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Brain data loaded: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Temporal split - Total time: 19081
Train: 0 to 16218 (85.0%)
Val: 16218 to 18126 (10.0%)
Test: 18126 to 19081 (5.0%)
Current split (test): 18094 to 19081
Selected top 5000 neurons out of 6903 total
Selected neuron std range: 0.105 to 0.267
Final dataset shape: (987, 5000)
Final data stats - Mean: 0.356, Std: 0.150
Sequences available: 948
test 948
mse:0.06216806918382645, mae:0.18044395744800568, rse:1.6619179248809814, corr:[0.02146109 0.02072588 0.01709038 0.01472945 0.01294957 0.01128871
 0.00991828 0.00790125]
