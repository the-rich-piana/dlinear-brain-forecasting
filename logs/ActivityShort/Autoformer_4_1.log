Args in experiment:
Namespace(is_training=1, model_id='Autoformer_4_1', model='Autoformer', data='Activity', root_path='./dataset/', data_path='session_0.h5', features='M', target='OT', freq='m', checkpoints='./checkpoints/', seq_len=4, label_len=4, pred_len=1, individual=False, embed_type=0, enc_in=5000, dec_in=5000, c_out=5000, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.01, des='Exp', loss='mae', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_4_1_Autoformer_Activity_ftM_sl4_ll4_pl1_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Loaded preprocessed data: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Selected top 5000 neurons out of 6903 preprocessed neurons
Final dataset shape: (13356, 5000)
Final data statistics - Mean: 0.347, Std: 0.149
train 13352
Loaded preprocessed data: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Selected top 5000 neurons out of 6903 preprocessed neurons
Final dataset shape: (1908, 5000)
Final data statistics - Mean: 0.378, Std: 0.158
val 1904
Loaded preprocessed data: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Selected top 5000 neurons out of 6903 preprocessed neurons
Final dataset shape: (3821, 5000)
Final data statistics - Mean: 0.325, Std: 0.143
test 3817
	iters: 100, epoch: 1 | loss: 2.1890321
	speed: 0.0523s/iter; left time: 212.9639s
	iters: 200, epoch: 1 | loss: 0.4971801
	speed: 0.0235s/iter; left time: 93.4500s
	iters: 300, epoch: 1 | loss: 0.3202457
	speed: 0.0215s/iter; left time: 83.1514s
	iters: 400, epoch: 1 | loss: 0.2237055
	speed: 0.0219s/iter; left time: 82.5577s
Epoch: 1 cost time: 9.98427128791809
Epoch: 1, Steps: 417 | Train Loss: 34.1734823 Vali Loss: 0.2920165 Test Loss: 0.2741922
Validation loss decreased (inf --> 0.292017).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.2117982
	speed: 0.0708s/iter; left time: 258.6890s
	iters: 200, epoch: 2 | loss: 0.1735656
	speed: 0.0239s/iter; left time: 85.0164s
	iters: 300, epoch: 2 | loss: 0.1435144
	speed: 0.0244s/iter; left time: 84.3385s
	iters: 400, epoch: 2 | loss: 0.1378126
	speed: 0.0239s/iter; left time: 80.1691s
Epoch: 2 cost time: 10.776726484298706
Epoch: 2, Steps: 417 | Train Loss: 0.1791644 Vali Loss: 0.1925250 Test Loss: 0.1807029
Validation loss decreased (0.292017 --> 0.192525).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.1237967
	speed: 0.0708s/iter; left time: 229.1531s
	iters: 200, epoch: 3 | loss: 0.1127822
	speed: 0.0221s/iter; left time: 69.2897s
	iters: 300, epoch: 3 | loss: 0.1202461
	speed: 0.0227s/iter; left time: 68.9022s
	iters: 400, epoch: 3 | loss: 0.1112118
	speed: 0.0218s/iter; left time: 63.9606s
Epoch: 3 cost time: 9.554244041442871
Epoch: 3, Steps: 417 | Train Loss: 0.1197970 Vali Loss: 0.1577042 Test Loss: 0.1482830
Validation loss decreased (0.192525 --> 0.157704).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1026791
	speed: 0.0967s/iter; left time: 272.6698s
	iters: 200, epoch: 4 | loss: 0.1022328
	speed: 0.0225s/iter; left time: 61.2581s
	iters: 300, epoch: 4 | loss: 0.0971411
	speed: 0.0215s/iter; left time: 56.4321s
	iters: 400, epoch: 4 | loss: 0.0986887
	speed: 0.0236s/iter; left time: 59.3975s
Epoch: 4 cost time: 9.99581003189087
Epoch: 4, Steps: 417 | Train Loss: 0.1026101 Vali Loss: 0.1445587 Test Loss: 0.1352672
Validation loss decreased (0.157704 --> 0.144559).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1029570
	speed: 0.0722s/iter; left time: 173.4456s
	iters: 200, epoch: 5 | loss: 0.0940904
	speed: 0.0228s/iter; left time: 52.5387s
	iters: 300, epoch: 5 | loss: 0.0969688
	speed: 0.0238s/iter; left time: 52.4608s
	iters: 400, epoch: 5 | loss: 0.0917736
	speed: 0.0247s/iter; left time: 52.0157s
Epoch: 5 cost time: 10.74159049987793
Epoch: 5, Steps: 417 | Train Loss: 0.0948387 Vali Loss: 0.1394231 Test Loss: 0.1305215
Validation loss decreased (0.144559 --> 0.139423).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.0865246
	speed: 0.0705s/iter; left time: 139.9510s
	iters: 200, epoch: 6 | loss: 0.0893136
	speed: 0.0266s/iter; left time: 50.1031s
	iters: 300, epoch: 6 | loss: 0.0890195
	speed: 0.0255s/iter; left time: 45.5740s
	iters: 400, epoch: 6 | loss: 0.0899781
	speed: 0.0218s/iter; left time: 36.7099s
Epoch: 6 cost time: 10.290249586105347
Epoch: 6, Steps: 417 | Train Loss: 0.0912280 Vali Loss: 0.1355392 Test Loss: 0.1272108
Validation loss decreased (0.139423 --> 0.135539).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.0869150
	speed: 0.0903s/iter; left time: 141.6205s
	iters: 200, epoch: 7 | loss: 0.0855326
	speed: 0.0223s/iter; left time: 32.7834s
	iters: 300, epoch: 7 | loss: 0.0943201
	speed: 0.0255s/iter; left time: 34.9106s
	iters: 400, epoch: 7 | loss: 0.0891164
	speed: 0.0256s/iter; left time: 32.4890s
Epoch: 7 cost time: 10.586066484451294
Epoch: 7, Steps: 417 | Train Loss: 0.0888268 Vali Loss: 0.1320872 Test Loss: 0.1242038
Validation loss decreased (0.135539 --> 0.132087).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.0912988
	speed: 0.0741s/iter; left time: 85.3877s
	iters: 200, epoch: 8 | loss: 0.0868391
	speed: 0.0250s/iter; left time: 26.2508s
	iters: 300, epoch: 8 | loss: 0.0873997
	speed: 0.0260s/iter; left time: 24.7175s
	iters: 400, epoch: 8 | loss: 0.0862789
	speed: 0.0257s/iter; left time: 21.8740s
Epoch: 8 cost time: 11.283989667892456
Epoch: 8, Steps: 417 | Train Loss: 0.0883694 Vali Loss: 0.1305660 Test Loss: 0.1226472
Validation loss decreased (0.132087 --> 0.130566).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.0861968
	speed: 0.0786s/iter; left time: 57.7416s
	iters: 200, epoch: 9 | loss: 0.0877650
	speed: 0.0247s/iter; left time: 15.6689s
	iters: 300, epoch: 9 | loss: 0.0879811
	speed: 0.0218s/iter; left time: 11.6370s
	iters: 400, epoch: 9 | loss: 0.0863158
	speed: 0.0216s/iter; left time: 9.3772s
Epoch: 9 cost time: 10.386200904846191
Epoch: 9, Steps: 417 | Train Loss: 0.0871770 Vali Loss: 0.1295884 Test Loss: 0.1218623
Validation loss decreased (0.130566 --> 0.129588).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.0855637
	speed: 0.0732s/iter; left time: 23.2857s
	iters: 200, epoch: 10 | loss: 0.0871470
	speed: 0.0234s/iter; left time: 5.1111s
	iters: 300, epoch: 10 | loss: 0.0830292
	speed: 0.0212s/iter; left time: 2.4997s
	iters: 400, epoch: 10 | loss: 0.0878514
	speed: 0.0218s/iter; left time: 0.3919s
Epoch: 10 cost time: 10.088138341903687
Epoch: 10, Steps: 417 | Train Loss: 0.0868456 Vali Loss: 0.1286577 Test Loss: 0.1208652
Validation loss decreased (0.129588 --> 0.128658).  Saving model ...
Updating learning rate to 1.953125e-05
>>>>>>>testing : Autoformer_4_1_Autoformer_Activity_ftM_sl4_ll4_pl1_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Loaded preprocessed data: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Selected top 5000 neurons out of 6903 preprocessed neurons
Final dataset shape: (3821, 5000)
Final data statistics - Mean: 0.325, Std: 0.143
test 3817
mse:0.030417805537581444, mae:0.12086513638496399, rse:1.2175872325897217, corr:[0.14830783]
