Args in experiment:
Namespace(is_training=1, model_id='Transformer_4_1', model='Transformer', data='Activity', root_path='./dataset/', data_path='session_0.h5', features='M', target='OT', freq='m', checkpoints='./checkpoints/', seq_len=4, label_len=4, pred_len=1, individual=False, embed_type=0, enc_in=5000, dec_in=5000, c_out=5000, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.01, des='Exp', loss='mae', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Transformer_4_1_Transformer_Activity_ftM_sl4_ll4_pl1_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Loaded preprocessed data: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Selected top 5000 neurons out of 6903 preprocessed neurons
Final dataset shape: (13356, 5000)
Final data statistics - Mean: 0.347, Std: 0.149
train 13352
Loaded preprocessed data: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Selected top 5000 neurons out of 6903 preprocessed neurons
Final dataset shape: (1908, 5000)
Final data statistics - Mean: 0.378, Std: 0.158
val 1904
Loaded preprocessed data: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Selected top 5000 neurons out of 6903 preprocessed neurons
Final dataset shape: (3821, 5000)
Final data statistics - Mean: 0.325, Std: 0.143
test 3817
	iters: 100, epoch: 1 | loss: 0.1397438
	speed: 0.0462s/iter; left time: 187.9711s
	iters: 200, epoch: 1 | loss: 0.1072446
	speed: 0.0147s/iter; left time: 58.5034s
	iters: 300, epoch: 1 | loss: 0.0917271
	speed: 0.0154s/iter; left time: 59.7874s
	iters: 400, epoch: 1 | loss: 0.0859152
	speed: 0.0152s/iter; left time: 57.2930s
Epoch: 1 cost time: 7.04532265663147
Epoch: 1, Steps: 417 | Train Loss: 0.2220157 Vali Loss: 0.0916257 Test Loss: 0.0899521
Validation loss decreased (inf --> 0.091626).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.0856641
	speed: 0.0527s/iter; left time: 192.5685s
	iters: 200, epoch: 2 | loss: 0.0859602
	speed: 0.0160s/iter; left time: 56.7806s
	iters: 300, epoch: 2 | loss: 0.0857840
	speed: 0.0172s/iter; left time: 59.3409s
	iters: 400, epoch: 2 | loss: 0.0873312
	speed: 0.0163s/iter; left time: 54.6684s
Epoch: 2 cost time: 7.118412494659424
Epoch: 2, Steps: 417 | Train Loss: 0.0867173 Vali Loss: 0.0899993 Test Loss: 0.0881774
Validation loss decreased (0.091626 --> 0.089999).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.0890030
	speed: 0.0519s/iter; left time: 167.9526s
	iters: 200, epoch: 3 | loss: 0.0894495
	speed: 0.0163s/iter; left time: 50.9779s
	iters: 300, epoch: 3 | loss: 0.0900575
	speed: 0.0159s/iter; left time: 48.4315s
	iters: 400, epoch: 3 | loss: 0.0860586
	speed: 0.0152s/iter; left time: 44.5144s
Epoch: 3 cost time: 6.877704381942749
Epoch: 3, Steps: 417 | Train Loss: 0.0855021 Vali Loss: 0.0909074 Test Loss: 0.0858878
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.0849050
	speed: 0.0406s/iter; left time: 114.3877s
	iters: 200, epoch: 4 | loss: 0.0858787
	speed: 0.0159s/iter; left time: 43.1295s
	iters: 300, epoch: 4 | loss: 0.0842278
	speed: 0.0168s/iter; left time: 44.0071s
	iters: 400, epoch: 4 | loss: 0.0848365
	speed: 0.0164s/iter; left time: 41.4033s
Epoch: 4 cost time: 7.112640619277954
Epoch: 4, Steps: 417 | Train Loss: 0.0850821 Vali Loss: 0.0909033 Test Loss: 0.0850064
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.0876636
	speed: 0.0410s/iter; left time: 98.5174s
	iters: 200, epoch: 5 | loss: 0.0845046
	speed: 0.0157s/iter; left time: 36.0640s
	iters: 300, epoch: 5 | loss: 0.0846141
	speed: 0.0165s/iter; left time: 36.4591s
	iters: 400, epoch: 5 | loss: 0.0833552
	speed: 0.0156s/iter; left time: 32.8456s
Epoch: 5 cost time: 7.011760950088501
Epoch: 5, Steps: 417 | Train Loss: 0.0848761 Vali Loss: 0.0902140 Test Loss: 0.0853622
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Transformer_4_1_Transformer_Activity_ftM_sl4_ll4_pl1_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Loaded preprocessed data: (19081, 6903)
Original neurons: 7673, Processed neurons: 6903
Data range: 0.000 to 1.000
Selected top 5000 neurons out of 6903 preprocessed neurons
Final dataset shape: (3821, 5000)
Final data statistics - Mean: 0.325, Std: 0.143
test 3817
mse:0.013965439982712269, mae:0.08817736059427261, rse:0.8250181078910828, corr:[-0.00032733]
